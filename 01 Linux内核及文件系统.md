# Linux核心

- 内核：运行程序和管理硬件的核心程序
- shell：内核和用户交互的界面，负责将用户指令传递给内核，一般分为图形化（GUI）和命令行（CLI）
  - GUI：一般为GNOME
  - CLI：一般是bash
- 文件系统
- 应用系统

## BASH

- 提示符：以`#`或`$`起始

  * `#`代表当前用户为root用户

  - `$`代表当前用户为普通用户

 高亮更改提示符颜色

```shell
ps1="\[\e[1;33m\][\u@\h \w]\\$\[\e[0m\]"
```

- 命令一般由三个参数构成：命令 -选项 参数
- Tab按键：自动补全命令、文件名，无法自动补全参数。当输入的命令/路径没有歧义，自动补全；当存在多种可能时，按两次tab，列出所有可能
- 历史记录
  - 使用上下键查看之前的命令
  - 使用history命令查看历史记录，历史记录放在内存里，正常退出后会写入家目录的.bash_history文件中，超过阈值就删除
- 调用历史记录以简化操作（主要用在脚本中）
  - `!!` 重复前一个命令
  - `!num` 按历史记录序号执行命令
  - `!字符` 重复前一个以指定字符开头的命令
  - `!?abc` 重复之前包含abc的命令
  - `!-n` 重复n个命令之前那个命令
- 命令行通配符
  - `*`匹配任意个
  - `？`匹配任意一个字符
  - `[m-n]` 匹配m至n间的任意一个
  - `[abc]` 匹配列表里任何字符
  - `[^abc]` 匹配列表以外字符
  - `[[:digit:]]`匹配任意一个数字
  - `[[:alpha:]]`匹配任意一个字母
  - `[[:lower:]]`匹配任意的小写字母
- 切换用户
  - `su username/su - username`：switch user，切换用户。前者是不完全切换，后者是完全切换
  - `exit`：退出当前用户
  - `sudo`： 使用管理员身份运行命令
    - `sudo passwd`可以修改当前用户的密码
    - `sudo id`可以显示当前用户的信息
- BASH作业管理
  - 通过在命令后追加一个`&`，可以将该命令放入后台运行
  - 通过以下命令可以管理后台作业
    - `jobs`  显示后台作业
    -  `fg`    将后台作业调到前台执行
    -  `bg`    继续执行一个后台作业

*  `Ctrl+z`暂停某个程序 
* 查看终端

```shell
tty
```

* 查看shell

```bash
cat /etc/shells
```

* 更改shell

```shell
chsh shellname
```

Linux系统的启动过程：

- 引导内核
- 运行 init
- 系统初始化
- 建立终端 
- 用户登录系统

# Linux文件系统

## Linux文件系统的组成

Linux一切皆文件，Linux文件系统是一个倒置的树形结构

- /：根目录，Linux系统最上层的目录，包含所有文件和目录
- etc：配置文件
- boot：存放内核与启动引导文件
- bin：二进制可执行命令文件，所有用户都有权限执行
- sbin：管理类的命令文件
- lib：库文件
- dev：设备文件，访问该目录下某个文件相当于访问某设备，比如硬盘（sd），网卡，终端（tty）
- home：普通用户的家目录，包括除root外的所有普通用户，每个普通用户的家目录是`/home/username`
- root：管理员的家目录
- shell：命令解释器，把命令转换成系统理解的语言，常用的是bash shell
- usr：一般不需要修改的应用程序，命令程序文件等
- var：存放经常变化的文件，比如日志文件
- mnt/media：挂载，给分区/外接设备分配一个目录名，该名称为挂载点
- lost+fount：系统异常产生错误时，会将一些遗失的片段放置于此目录下
- tmp：临时文件，内容会自动删除

 绝大多数程序都有相应的帮助文档，保存在/usr/share/doc中

显示树结构

```shell
tree direction
```

只显示目录

```shell
tree -d 
```

显示level层级的树结构

```shell
tree -L level 
```

**绝对路径和相对路径**

- 相对路径：在输入路径时，最前面不是 / 或者 ~，表示相对当前目录所在的目录位置
  - `.`当前目录
  - `..`上级目录
  - `~`当前用户家目录
- 绝对路径：在输入路径时，最前面是 / 或者~，表示从根目录/家目录开始的具体目录位置

查看当前路径

```shell
pwd
```

## 文件系统与目录结构

文件名区分大小写，以.开头的是隐藏文件，分为basename（文件名）和dirname（路径名）

```shell
basename filename

dirname filename
```

文件有两类数据：

- 元数据：文件类型，权限，修改时间等
- 数据：文件内容

### 文件命名规则

文件名最长255字节，蓝色表示目录，白色表示文件，红色表示打包文件，淡蓝色表示链接文件，绿色表示可执行文件。除了`/`，其他字符都可做为文件名，但最好避免使用特殊字符

### 文件类型

- `-`普通文件
- d：目录
- b：block，块设备
- c：character，字符设备
- l：链接文件
- p：pipe，管道文件
- s：socket，套接字文件

**节点索引（Inode）**：文件身份的唯一标识，有限的，使用完毕会提示空间已满。不同分区的文件节点索引可以是一样的

删除文件其实是删除了节点索引，文件数据还在，存储文件数据的那部分空间被标记为可用，只有覆盖了才会真正删除

查看节点索引

```bash
ls -i
```

查看文件类型

```shell
file filename 
```

### 链接文件

分为硬链接和软链接

软链接：指向文件名，不同文件的节点索引不一样，文件内容一致。不占用空间，原文件删除，软链接文件失效，可以看成是Windows的快捷方式。一旦新建同名文件，软链接又会恢复。可以对目录跨分区建立软链接，链接数不变 

硬链接：指向文件内容，对一个文件起多个名字，节点索引是一样的，删除一个其他还存在。不能跨分区创建，因为本质上指向一个文件。不能对目录作硬链接，链接数会增加。原文件删除，链接文件还存在

硬链接

```shell
ln 原文件 链接文件
```

软链接

```shell
ln -s 原文件 链接文件
```

**虚拟机的下载上传工具lrzsz**

安装

```shell
yum -y install lrzsz
```

上传进虚拟机

```bash
rz
```

下载进物理机

```bash
sz file 
```







